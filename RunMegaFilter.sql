create or replace function RunMegaFilter(food text, spark text, transport text, service text, second_lang text, min_fee int, max_fee int, citizenship text, level text, type_service text, user_lat float, user_long float, distance float)
  returns table (centre_code text, latitude float, longitude float)
  language plpgsql STABLE
  as
$$
begin
  if (spark = 'Yes') then
    if (transport = 'Yes') then
        if (service = 'Default') then
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        else
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        end if;
    else
        if (service = 'Default') then
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        else
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and ps.service=service and "spark_certified"='Yes' and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        end if;
    end if;
else
    if (transport = 'Yes') then
        if (service = 'Default') then
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        else
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and ps.service=service and ps.provision_of_transport='Yes'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        end if;
    else
        if (service = 'Default') then
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food'  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        else
            if (food = 'Default') then
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            else
                if (second_lang = 'Chinese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Chinese" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Malay') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Malay" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Tamil') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Tamil" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'French') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_French" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Arabic') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Arabic" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Russian') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Russian" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'German') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_German" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Japanese') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Japanese" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Hindi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Hindi" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Korean') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Korean" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                elsif (second_lang = 'Punjabi') then
                    return query select ps.centre_code, c.latitude, c.longitude from "PreSchool" ps, "Fees" f, "Coords" c where f.centre_code = ps.centre_code and ps.centre_code = c.centre_code and "Lang_Punjabi" = true and ps.food='food' and ps.service=service  and (((c.latitude - user_lat)*(c.latitude - user_lat)) + ((c.longitude - user_long)*(c.longitude - user_long)) <= (distance*distance/10000))  and f.fees <= max_fee and f.fees >= min_fee and f.type_of_citizenship = citizenship and f.levels_offered = level and f.type_of_service = type_service;
                end if;
            end if;
        end if;
    end if;
end if;
end;
$$;
